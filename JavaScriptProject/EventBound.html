<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>test</title>
    <script src="http://lib.sinaapp.com/js/jquery/2.0.2/jquery-2.0.2.min.js"></script>
  </head>
  <body>
    <form id="test-form" action="test">
    <legend>请选择想要学习的编程语言：</legend>
    <fieldset>
        <p><label class="selectAll"><input type="checkbox" id="test"> <span class="selectAll">全选</span><span class="deselectAll">全不选</span></label> <a href="#0" class="invertSelect">反选</a></p>
        <p><label><input type="checkbox" name="lang" value="javascript"> JavaScript</label></p>
        <p><label><input type="checkbox" name="lang" value="python"> Python</label></p>
        <p><label><input type="checkbox" name="lang" value="ruby"> Ruby</label></p>
        <p><label><input type="checkbox" name="lang" value="haskell"> Haskell</label></p>
        <p><label><input type="checkbox" name="lang" value="scheme"> Scheme</label></p>
        <p><button type="submit">Submit</button></p>
    </fieldset>
</form>
  </body>
  <script type="text/javascript">

var
  form = $('#test-form'),
  langs = form.find('[name=lang]'),
  selectAll = form.find('label.selectAll :checkbox'),
  selectAllLabel = form.find('label.selectAll span.selectAll'),
  deselectAllLabel = form.find('label.selectAll span.deselectAll'),
  invertSelect = form.find('a.invertSelect'),
  isSelectAllLable = false;
  // 重置初始化状态:
form.find('*').show().off();
form.find(':checkbox').prop('checked', false).off();
deselectAllLabel.hide();
// 拦截form提交事件:
form.off().submit(function (e) {
    e.preventDefault();
    alert(form.serialize());
});
form.change(function(){
    if(form.find('[name=lang]:checked').length === 5){
        selectAllLabel.hide();
        deselectAllLabel.show();
        selectAll.prop('checked',true);
    }else{
        selectAllLabel.show();
        deselectAllLabel.hide();
        selectAll.prop('checked',false);
    }
});
  $(selectAll).click(function () {
     if($(this).is(':checked')){
       selectAllLabel.hide();
       deselectAllLabel.show();
       langs.prop('checked', 'true');
       $(this).prop('checked', 'true');

     }
     else{
       selectAllLabel.show();
       deselectAllLabel.hide();
       langs.each(function(){
           $(this).is(':checked')?$(this).prop('checked',false):$(this).prop('checked',true);
     });
       //$(this).prop('checked', 'false');
     }
  });
  $(invertSelect).click(function() {
    /* Act on the event */
    if(selectAll.is(':checked')){
      selectAllLabel.hide();
      deselectAllLabel.show();
      selectAll.each(function(){
          $(this).is(':checked')?$(this).prop('checked',false):$(this).prop('checked',true);
    });
      langs.each(function(){
          $(this).is(':checked')?$(this).prop('checked',false):$(this).prop('checked',true);
    });
    }
    else{
      selectAllLabel.show();
      deselectAllLabel.hide();
      selectAll.each(function(){
          $(this).is(':checked')?$(this).prop('checked',false):$(this).prop('checked',true);
    });
      langs.each(function(){
          $(this).is(':checked')?$(this).prop('checked',false):$(this).prop('checked',true);
    });
    }
  });



  </script>
</html>
